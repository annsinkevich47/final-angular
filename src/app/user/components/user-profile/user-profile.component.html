<div class="profile">
  <h2 class="profile__title">Profile</h2>

  <button (click)="openPasswordModal()">Change Password</button>

  <div class="profile__field field">
    <span class="field__title">Name</span>
    <span class="field__name" *ngIf="!currentUser"> Loading... </span>
    <span class="field__name" *ngIf="currentUser">
      <ng-container *ngIf="!isEditingName; else editNameTemplate">
        {{ currentUser.name ?? 'User' }}
        <button (click)="toggleEditName()">
          <svg
            width="100"
            height="100"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="m3.99 16.854-1.314 3.504a.75.75 0 0 0 .966.965l3.503-1.314a3 3 0 0 0 1.068-.687L18.36 9.175s-.354-1.061-1.414-2.122c-1.06-1.06-2.122-1.414-2.122-1.414L4.677 15.786a3 3 0 0 0-.687 1.068zm12.249-12.63 1.383-1.383c.248-.248.579-.406.925-.348.487.08 1.232.322 1.934 1.025.703.703.945 1.447 1.025 1.934.058.346-.1.677-.348.925L19.774 7.76s-.353-1.06-1.414-2.12c-1.06-1.062-2.121-1.415-2.121-1.415z"
              fill="#3572ce" />
          </svg></button></ng-container
      ><ng-template #editNameTemplate>
        <input type="text" [formControl]="editNameInput" />
        <button (click)="saveName()" [disabled]="!isNameValid()">
          <svg
            width="100px"
            height="100px"
            viewBox="0 -0.5 21 21"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            fill="#000000">
            <g id="SVGRepo_bgCarrier" stroke-width="0" />
            <g
              id="SVGRepo_tracerCarrier"
              stroke-linecap="round"
              stroke-linejoin="round" />
            <g id="SVGRepo_iconCarrier">
              <title>save_item [#3572ce]</title>
              <desc>Created with Sketch.</desc>
              <defs></defs>
              <g
                id="Page-1"
                stroke="none"
                stroke-width="1"
                fill="none"
                fill-rule="evenodd">
                <g
                  id="Dribbble-Light-Preview"
                  transform="translate(-59.000000, -680.000000)"
                  fill="#3572ce">
                  <g id="icons" transform="translate(56.000000, 160.000000)">
                    <path
                      d="M10.21875,524 C10.21875,523.448 10.68915,523 11.26875,523 C11.84835,523 12.31875,523.448 12.31875,524 C12.31875,524.552 11.84835,525 11.26875,525 C10.68915,525 10.21875,524.552 10.21875,524 L10.21875,524 Z M19.8,535 C19.8,535.552 19.3296,536 18.75,536 L8.25,536 C7.6704,536 7.2,535.552 7.2,535 C7.2,534.448 7.6704,534 8.25,534 L18.75,534 C19.3296,534 19.8,534.448 19.8,535 L19.8,535 Z M19.8,531 C19.8,531.552 19.3296,532 18.75,532 L8.25,532 C7.6704,532 7.2,531.552 7.2,531 C7.2,530.448 7.6704,530 8.25,530 L18.75,530 C19.3296,530 19.8,530.448 19.8,531 L19.8,531 Z M21.9,537 C21.9,537.552 21.4296,538 20.85,538 L6.15,538 C5.5704,538 5.1,537.552 5.1,537 L5.1,527.044 C5.1,526.911 5.15565,526.784 5.2533,526.691 L7.2,524.837 L7.2,526 C7.2,527.105 8.13975,528 9.3,528 L17.7,528 C18.86025,528 19.8,527.105 19.8,526 L19.8,522 L20.85,522 C21.4296,522 21.9,522.448 21.9,523 L21.9,537 Z M9.3,522.837 L10.02555,522.146 C10.1232,522.053 10.2576,522 10.3962,522 L17.7,522 L17.7,525 C17.7,525.552 17.2296,526 16.65,526 L10.35,526 C9.7704,526 9.3,525.552 9.3,525 L9.3,522.837 Z M21.9,520 L9.75045,520 C9.4722,520 9.2055,520.105 9.00915,520.292 L3.31185,525.707 C3.11445,525.895 3.0042,526.149 3.0042,526.415 L3,538 C3,539.104 3.93975,540 5.09895,540 L21.9,540 C23.06025,540 24,539.105 24,538 L24,522 C24,520.895 23.06025,520 21.9,520 L21.9,520 Z"
                      id="save_item-[#3572ce]"></path>
                  </g>
                </g>
              </g>
            </g>
          </svg>
        </button>
      </ng-template>
    </span>
  </div>

  <div class="profile__field field">
    <span class="field__title">Email</span>
    <span class="field__email" *ngIf="!currentUser"> Loading... </span>
    <span class="field__email" *ngIf="currentUser">
      <ng-container *ngIf="!isEditingEmail; else editEmailTemplate">
        {{ currentUser.email }}
        <button (click)="toggleEditEmail()">
          <svg
            width="100"
            height="100"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="m3.99 16.854-1.314 3.504a.75.75 0 0 0 .966.965l3.503-1.314a3 3 0 0 0 1.068-.687L18.36 9.175s-.354-1.061-1.414-2.122c-1.06-1.06-2.122-1.414-2.122-1.414L4.677 15.786a3 3 0 0 0-.687 1.068zm12.249-12.63 1.383-1.383c.248-.248.579-.406.925-.348.487.08 1.232.322 1.934 1.025.703.703.945 1.447 1.025 1.934.058.346-.1.677-.348.925L19.774 7.76s-.353-1.06-1.414-2.12c-1.06-1.062-2.121-1.415-2.121-1.415z"
              fill="#3572ce" />
          </svg></button></ng-container
      ><ng-template #editEmailTemplate>
        <input type="email" [formControl]="editEmailInput" />
        <button
          (click)="saveEmail()"
          [disabled]="!!emailError || !isEmailValid()">
          <svg
            width="100px"
            height="100px"
            viewBox="0 -0.5 21 21"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            fill="#000000">
            <g id="SVGRepo_bgCarrier" stroke-width="0" />
            <g
              id="SVGRepo_tracerCarrier"
              stroke-linecap="round"
              stroke-linejoin="round" />
            <g id="SVGRepo_iconCarrier">
              <title>save_item [#3572ce]</title>
              <desc>Created with Sketch.</desc>
              <defs></defs>
              <g
                id="Page-1"
                stroke="none"
                stroke-width="1"
                fill="none"
                fill-rule="evenodd">
                <g
                  id="Dribbble-Light-Preview"
                  transform="translate(-59.000000, -680.000000)"
                  fill="#3572ce">
                  <g id="icons" transform="translate(56.000000, 160.000000)">
                    <path
                      d="M10.21875,524 C10.21875,523.448 10.68915,523 11.26875,523 C11.84835,523 12.31875,523.448 12.31875,524 C12.31875,524.552 11.84835,525 11.26875,525 C10.68915,525 10.21875,524.552 10.21875,524 L10.21875,524 Z M19.8,535 C19.8,535.552 19.3296,536 18.75,536 L8.25,536 C7.6704,536 7.2,535.552 7.2,535 C7.2,534.448 7.6704,534 8.25,534 L18.75,534 C19.3296,534 19.8,534.448 19.8,535 L19.8,535 Z M19.8,531 C19.8,531.552 19.3296,532 18.75,532 L8.25,532 C7.6704,532 7.2,531.552 7.2,531 C7.2,530.448 7.6704,530 8.25,530 L18.75,530 C19.3296,530 19.8,530.448 19.8,531 L19.8,531 Z M21.9,537 C21.9,537.552 21.4296,538 20.85,538 L6.15,538 C5.5704,538 5.1,537.552 5.1,537 L5.1,527.044 C5.1,526.911 5.15565,526.784 5.2533,526.691 L7.2,524.837 L7.2,526 C7.2,527.105 8.13975,528 9.3,528 L17.7,528 C18.86025,528 19.8,527.105 19.8,526 L19.8,522 L20.85,522 C21.4296,522 21.9,522.448 21.9,523 L21.9,537 Z M9.3,522.837 L10.02555,522.146 C10.1232,522.053 10.2576,522 10.3962,522 L17.7,522 L17.7,525 C17.7,525.552 17.2296,526 16.65,526 L10.35,526 C9.7704,526 9.3,525.552 9.3,525 L9.3,522.837 Z M21.9,520 L9.75045,520 C9.4722,520 9.2055,520.105 9.00915,520.292 L3.31185,525.707 C3.11445,525.895 3.0042,526.149 3.0042,526.415 L3,538 C3,539.104 3.93975,540 5.09895,540 L21.9,540 C23.06025,540 24,539.105 24,538 L24,522 C24,520.895 23.06025,520 21.9,520 L21.9,520 Z"
                      id="save_item-[#3572ce]"></path>
                  </g>
                </g>
              </g>
            </g>
          </svg>
        </button>
        <span *ngIf="emailError" class="field__error">{{ emailError }}</span>
      </ng-template>
    </span>
  </div>

  <div class="profile__modal modal" *ngIf="isPasswordModalOpen">
    <h3 class="modal__title">Change Password</h3>
    <label for="newPassword">New Password</label>
    <input
      type="{{ isHoveredPassword ? 'text' : 'password' }}"
      placeholder="Enter at least 8 characters"
      id="newPassword"
      [formControl]="editPasswordInput"
      (mouseenter)="isHoveredPassword = true"
      (mouseleave)="isHoveredPassword = false" />
    <button
      class="modal__button"
      (click)="changePassword()"
      [disabled]="!isPassLengthValid()">
      Save
    </button>
  </div>

  <button class="profile__logout" (click)="logout()">Logout</button>
</div>
